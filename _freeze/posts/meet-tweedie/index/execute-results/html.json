{
  "hash": "55a2b4965e68275ce3ac630e8b188d86",
  "result": {
    "markdown": "---\ntitle: \"Meet Tweedie\"\nsubtitle: \"An exploration of the Tweedie family of distributions\"\ndate: \"2023-03-07\"\ncategories: [\"statistics\", \"code\"] # environmental-change, tagging-and-telemetry, allee-effects, invasive-species, statistics, code\nimage: \"tweedie.png\"\nimage-alt: \"Tweedie says 'hi'\"\nfilters:\n   - lightbox\nlightbox: auto\n---\n\n\nI'm working with some spatio-temporally patchy fisheries count data. To allow for their highly variable nature, I was recommended to look at the Tweedie family of distributions. I thought I'd write a post to introduce Tweedie and what I learnt.\n\n# Tweedie definition\n\nThe Tweedie distributions are a subfamily of the Exponential distributions, but with a special mean-variance relationship with:\n\n- a mean of $E(Y) = \\mu$;\n- a positive dispersion parameter $\\sigma^2$; and\n- a variance of $Var(Y) = \\sigma^2 \\mu^p$.\n\nThe $p$ in the variance function is often called the \"Tweedie power\" parameter and acts as an additional shape parameter for the distribution. It is sometimes written in terms of the shape parameter $\\alpha$:\n\n$$\np = \\frac{(\\alpha - 2)}{(\\alpha - 1)}\n$$\n\nSome familiar distributions are special cases of the Tweedie distribution:\n\n-   $p = 0$: Normal distribution;\n-   $p = 1$: Poisson distribution;\n-   $1 < p < 2$: Compound Poisson/gamma distribution;\n-   $p = 2$: gamma distribution;\n-   $2 < p < 3$: Positive stable distributions;\n-   $p = 3$: Inverse Gaussian distribution / Wald distribution;\n-   $p > 3$: Positive stable distributions; and\n-   $p = \\infty$: Extreme stable distributions.\n\n(Note that the distribution is not defined for $p$ values $0 < p < 1$.)\n\n# Poisson-like Tweedie cases\n\nSince I am working with counts, the Tweedie distributions related to the Poisson distribution were of particular interest to me. Specifically, I was interested to explore the Tweedie distributions with power parameter values from 1 to 2.\n\nWith the help of the [`R`](https://www.r-project.org/) package [`tweedie`](https://cran.r-project.org/package=tweedie), we can plot histograms of those distributions as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# libraries\nlibrary(tweedie)\nlibrary(data.table)\nlibrary(ggplot2)\n\n# xis (also known as powers)\nxis <- seq(1, 2, length.out = 12)\n\n# make wide\nd <- as.data.table(lapply(xis, \n                          function(v) \n                            rtweedie(n = 1000, mu = 1, phi = 1, xi = v)))\n\n# set names\nsetnames(d, colnames(d), paste0(\"xi = \", sprintf(\"%.01f\", xis)))\n\n# make long\ndl <- stack(d)\n\n# make plot\np <- ggplot(dl, aes(x = values)) +\n  geom_histogram(binwidth = 0.1) +\n  facet_wrap(~ ind) +\n  labs(x = \"value\", y = \"frequency\") +\n  theme_minimal()\n\n# save plot\njpeg(\"tweedie-histograms.jpg\", res = 300, width = (480 * 5), height = (480 * 5))\nprint(p)\ndev.off()\n```\n:::\n\n\n\n![](tweedie-histograms.jpg)\n\n\nIt is interesting to note that as $p \\to 1$ so the Tweedie distribution does allow for greater mass of points at 0 (zero). This is a particularly useful feature of the Tweedie when dealing with highly variable and sometimes low counts that are frequently on or around 0.\n\n\n# Using the Tweedie\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}